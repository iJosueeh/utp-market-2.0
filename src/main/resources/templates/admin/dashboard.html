<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{admin/_admin_layout :: layout(title='Admin Dashboard', pageContent=~{::pageContent}, includeChartJS_=true)}">

<th:block th:fragment="pageContent">
    <!-- Contenido específico del Dashboard -->
    <div class="container-fluid">
        <!-- Título de la página -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="h3 fw-bold">Dashboard</h1>
            <a th:href="@{/admin/reportes}" class="btn btn-primary">
                <i class="bi bi-plus-circle me-2"></i>Crear Reporte
            </a>
        </div>

        <!-- Tarjetas de Estadísticas -->
        <div class="row g-4 mb-4">
            <div class="col-md-6 col-lg-3">
                <div class="card stat-card bg-utp-red text-white">
                    <div class="card-body">
                        <div>
                            <h5 class="card-title">Usuarios Totales</h5>
                            <p class="card-text fs-4 fw-bold" th:text="${totalUsuarios}">1,250</p>
                        </div>
                        <div class="stat-icon">
                            <i class="bi bi-people-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card stat-card bg-utp-dark-red text-white">
                    <div class="card-body">
                        <div>
                            <h5 class="card-title">Ventas Totales</h5>
                            <p class="card-text fs-4 fw-bold" th:text="'S/ ' + ${#numbers.formatDecimal(totalVentas, 1, 'COMMA', 2, 'POINT')}">S/ 12,840</p>
                        </div>
                        <div class="stat-icon">
                            <i class="bi bi-cash-coin"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card stat-card bg-utp-accent-orange text-white">
                    <div class="card-body">
                        <div>
                            <h5 class="card-title">Pedidos Pendientes</h5>
                            <p class="card-text fs-4 fw-bold" th:text="${pedidosPendientes}">72</p>
                        </div>
                        <div class="stat-icon">
                            <i class="bi bi-clock-history"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card stat-card bg-utp-accent-blue text-white">
                    <div class="card-body">
                        <div>
                            <h5 class="card-title">Productos Totales</h5>
                            <p class="card-text fs-4 fw-bold" th:text="${totalProductos}">15</p>
                        </div>
                        <div class="stat-icon">
                            <i class="bi bi-box-seam-fill"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gráfico de Ventas -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card shadow-sm">
                    <div class="card-header">
                        <h5 class="card-title mb-0 fw-bold">Ventas de los Últimos 30 Días</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="ventasChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabla de Actividad Reciente -->
        <div class="card shadow-sm mt-4">
            <div class="card-header">
                <h5 class="card-title mb-0 fw-bold">Pedidos Recientes</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead>
                        <tr>
                            <th scope="col">Tipo</th>
                            <th scope="col">Número Pedido</th>
                            <th scope="col">Usuario</th>
                            <th scope="col">Fecha</th>
                            <th scope="col">Estado</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="pedido : ${pedidosRecientes}">
                            <td><span class="badge bg-success-soft text-success">Pedido</span></td>
                            <td th:text="${pedido.numero_pedido}">#PED-A4S3D</td>
                            <td th:text="${pedido.usuario.nombreCompleto}">Juan Pérez</td>
                            <td th:text="${#dates.format(pedido.fecha_pedido, 'dd/MM/yyyy HH:mm')}">Hace 5 minutos</td>
                            <td>
                                <span class="badge" th:classappend="${#strings.equals(pedido.estado.nombre, 'COMPLETADO')} ? 'bg-success' : (${#strings.equals(pedido.estado.nombre, 'PENDIENTE')} ? 'bg-warning text-dark' : 'bg-secondary')" th:text="${pedido.estado.nombre}">Completado</span>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</th:block>
</html>
